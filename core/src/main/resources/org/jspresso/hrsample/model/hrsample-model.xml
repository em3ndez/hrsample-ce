<?xml version="1.0" encoding="UTF-8"?>
<beans
  xmlns="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
                      http://www.springframework.org/schema/beans/spring-beans-2.5.xsd"
  default-lazy-init="true">

  <!-- Commons model  -->

  <bean
    id="Nameable"
    class="org.jspresso.framework.model.descriptor.basic.BasicInterfaceDescriptor">
    <constructor-arg value="org.jspresso.hrsample.model.Nameable" />
    <property name="propertyDescriptors">
      <list>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicStringPropertyDescriptor">
          <property
            name="name"
            value="name" />
          <property
            name="maxLength"
            value="64" />
          <property
            name="mandatory"
            value="true" />
        </bean>
      </list>
    </property>
  </bean>

  <bean
    id="Traceable"
    class="org.jspresso.framework.model.descriptor.basic.BasicInterfaceDescriptor">
    <constructor-arg value="org.jspresso.hrsample.model.Traceable" />
    <property name="propertyDescriptors">
      <list>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicDatePropertyDescriptor">
          <property
            name="name"
            value="createTimestamp" />
          <property
            name="type"
            ref="DATE_TIME" />
          <property
            name="readOnly"
            value="true" />
        </bean>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicDatePropertyDescriptor">
          <property
            name="name"
            value="lastUpdateTimestamp" />
          <property
            name="type"
            ref="DATE_TIME" />
          <property
            name="readOnly"
            value="true" />
            <property name="grantedRoles">
            <list><value>test</value></list>
            </property>
        </bean>
      </list>
    </property>
    <property name="unclonedProperties">
      <list>
        <value>createTimestamp</value>
        <value>lastUpdateTimestamp</value>
      </list>
    </property>
    <property name="lifecycleInterceptors">
      <list>
        <bean
          class="org.jspresso.hrsample.model.service.TraceableLifecycleInterceptor" />
      </list>
    </property>
    <property
      name="iconImageURL"
      value="classpath:org/jspresso/hrsample/images/traceable-48x48.png" />
  </bean>

  <bean
    id="City"
    class="org.jspresso.framework.model.descriptor.entity.basic.BasicEntityDescriptor">
    <constructor-arg value="org.jspresso.hrsample.model.City" />
    <property name="ancestorDescriptors">
      <list>
        <ref local="Nameable" />
      </list>
    </property>
    <property name="propertyDescriptors">
      <list>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicStringPropertyDescriptor">
          <property
            name="name"
            value="zip" />
          <property
            name="maxLength"
            value="10" />
        </bean>
      </list>
    </property>
    <property
      name="iconImageURL"
      value="classpath:org/jspresso/hrsample/images/city-48x48.png" />
  </bean>

  <bean
    id="ContactInfo"
    class="org.jspresso.framework.model.descriptor.basic.BasicComponentDescriptor">
    <constructor-arg value="org.jspresso.hrsample.model.ContactInfo" />
    <property name="propertyDescriptors">
      <list>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicStringPropertyDescriptor">
          <property
            name="name"
            value="address" />
          <property
            name="maxLength"
            value="256" />
        </bean>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicReferencePropertyDescriptor">
          <property
            name="name"
            value="city" />
          <property
            name="referencedDescriptor"
            ref="City" />
        </bean>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicStringPropertyDescriptor">
          <property
            name="name"
            value="phone" />
          <property
            name="maxLength"
            value="32" />
        </bean>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicStringPropertyDescriptor">
          <property
            name="name"
            value="email" />
          <property
            name="maxLength"
            value="128" />
          <property
            name="regexpPattern"
            value="[\w\-\.]*@[\w\-\.]*" />
          <property
            name="regexpPatternSample"
            value="contact@acme.com" />
        </bean>
      </list>
    </property>
  </bean>

  <bean
    id="Event.text"
    class="org.jspresso.framework.model.descriptor.basic.BasicTextPropertyDescriptor">
    <property
      name="name"
      value="text" />
    <property
      name="maxLength"
      value="2048" />
  </bean>

  <bean
    id="Event"
    class="org.jspresso.framework.model.descriptor.entity.basic.BasicEntityDescriptor">
    <constructor-arg value="org.jspresso.hrsample.model.Event" />
    <property name="ancestorDescriptors">
      <list>
        <ref local="Traceable" />
      </list>
    </property>
    <property name="propertyDescriptors">
      <list>
        <ref bean="Event.text" />
      </list>
    </property>
  </bean>

  <bean
    id="contact"
    class="org.jspresso.framework.model.descriptor.basic.BasicReferencePropertyDescriptor">
    <property
      name="name"
      value="contact" />
    <property
      name="referencedDescriptor"
      ref="ContactInfo" />
  </bean>

  <!-- Employees model  -->

  <bean
    id="Employee"
    class="org.jspresso.framework.model.descriptor.entity.basic.BasicEntityDescriptor">
    <constructor-arg value="org.jspresso.hrsample.model.Employee" />
    <property name="ancestorDescriptors">
      <list>
        <ref local="Nameable" />
        <ref local="Traceable" />
      </list>
    </property>
    <property name="propertyDescriptors">
      <list>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicStringPropertyDescriptor">
          <property
            name="name"
            value="firstName" />
          <property
            name="maxLength"
            value="32" />
          <property name="integrityProcessors">
            <list>
              <bean
                class="org.jspresso.hrsample.model.processor.EmployeePropertyProcessors$FirstNameProcessor" />
            </list>
          </property>
        </bean>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicStringPropertyDescriptor">
          <property
            name="name"
            value="ssn" />
          <property
            name="maxLength"
            value="10" />
          <property
            name="regexpPattern"
            value="[\d]{10}" />
          <property
            name="regexpPatternSample"
            value="0123456789" />
          <property
            name="unicityScope"
            value="empSsn" />
        </bean>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicDatePropertyDescriptor">
          <property
            name="name"
            value="birthDate" />
          <property
            name="type"
            ref="DATE" />
          <property name="integrityProcessors">
            <list>
              <bean
                class="org.jspresso.hrsample.model.processor.EmployeePropertyProcessors$BirthDateProcessor" />
            </list>
          </property>
        </bean>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicDatePropertyDescriptor">
          <property
            name="name"
            value="hireDate" />
          <property
            name="type"
            ref="DATE" />
        </bean>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicEnumerationPropertyDescriptor">
          <property
            name="name"
            value="gender" />
          <property
            name="enumerationName"
            value="GENDER" />
          <property
            name="maxLength"
            value="1" />
          <property
            name="mandatory"
            value="true" />
          <property name="valuesAndIconImageUrls">
            <map>
              <entry
                key="M"
                value="classpath:org/jspresso/hrsample/images/male-48x48.png" />
              <entry
                key="F"
                value="classpath:org/jspresso/hrsample/images/female-48x48.png" />
            </map>
          </property>
        </bean>
        <ref bean="contact" />
        <ref local="Employee-events" />
        <ref local="Employee-teams" />
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicReferencePropertyDescriptor">
          <property
            name="name"
            value="company" />
          <property
            name="referencedDescriptor"
            ref="Company" />
          <property
            name="reverseRelationEnd"
            ref="Company-employees" />
          <property
            name="mandatory"
            value="true" />
        </bean>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicReferencePropertyDescriptor">
          <property
            name="name"
            value="managedOu" />
          <property
            name="referencedDescriptor"
            ref="OrganizationalUnit" />
          <property
            name="reverseRelationEnd"
            ref="OrganizationalUnit-manager" />
        </bean>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicIntegerPropertyDescriptor">
          <property
            name="name"
            value="age" />
          <property
            name="minValue"
            value="0" />
          <property
            name="maxValue"
            value="150" />
          <property
            name="delegateClassName"
            value="org.jspresso.hrsample.model.extension.EmployeeExtension" />
        </bean>
      </list>
    </property>
    <property name="serviceDelegates">
      <map>
        <entry key="org.jspresso.hrsample.model.service.EmployeeService">
          <bean
            class="org.jspresso.hrsample.model.service.EmployeeServiceDelegate" />
        </entry>
      </map>
    </property>
    <property
      name="iconImageURL"
      value="classpath:org/jspresso/hrsample/images/male-48x48.png" />
    <property name="renderedProperties">
      <list>
        <value>name</value>
        <value>firstName</value>
        <value>gender</value>
        <value>birthDate</value>
        <value>age</value>
        <value>ssn</value>
        <value>contact</value>
        <value>company</value>
        <value>createTimestamp</value>
        <value>lastUpdateTimestamp</value>
      </list>
    </property>
  </bean>

  <bean
    id="Employee-teams"
    class="org.jspresso.framework.model.descriptor.basic.BasicCollectionPropertyDescriptor">
    <property
      name="name"
      value="teams" />
    <property name="referencedDescriptor">
      <bean
        class="org.jspresso.framework.model.descriptor.basic.BasicCollectionDescriptor">
        <property
          name="collectionInterface"
          value="java.util.Set" />
        <property
          name="elementDescriptor"
          ref="Team" />
      </bean>
    </property>
  </bean>

  <bean
    id="Team-teamMembers"
    class="org.jspresso.framework.model.descriptor.basic.BasicCollectionPropertyDescriptor">
    <property
      name="name"
      value="teamMembers" />
    <property name="referencedDescriptor">
      <bean
        class="org.jspresso.framework.model.descriptor.basic.BasicCollectionDescriptor">
        <property
          name="collectionInterface"
          value="java.util.Set" />
        <property
          name="elementDescriptor"
          ref="Employee" />
      </bean>
    </property>
    <property
      name="reverseRelationEnd"
      ref="Employee-teams" />
  </bean>

  <bean
    id="Employee-events"
    class="org.jspresso.framework.model.descriptor.basic.BasicCollectionPropertyDescriptor">
    <property
      name="name"
      value="events" />
    <property
      name="composition"
      value="true" />
    <property name="referencedDescriptor">
      <bean
        class="org.jspresso.framework.model.descriptor.basic.BasicCollectionDescriptor">
        <property
          name="collectionInterface"
          value="java.util.List" />
        <property
          name="elementDescriptor"
          ref="Event" />
      </bean>
    </property>
  </bean>

  <!-- Organization model  -->

  <bean
    id="Company-departments"
    class="org.jspresso.framework.model.descriptor.basic.BasicCollectionPropertyDescriptor">
    <property
      name="name"
      value="departments" />
    <property
      name="composition"
      value="true" />
    <property name="referencedDescriptor">
      <bean
        class="org.jspresso.framework.model.descriptor.basic.BasicCollectionDescriptor">
        <property
          name="collectionInterface"
          value="java.util.Set" />
        <property
          name="elementDescriptor"
          ref="Department" />
      </bean>
    </property>
  </bean>

  <bean
    id="Company-employees"
    class="org.jspresso.framework.model.descriptor.basic.BasicCollectionPropertyDescriptor">
    <property
      name="name"
      value="employees" />
    <property
      name="composition"
      value="true" />
    <property name="referencedDescriptor">
      <bean
        class="org.jspresso.framework.model.descriptor.basic.BasicCollectionDescriptor">
        <property
          name="collectionInterface"
          value="java.util.Set" />
        <property
          name="elementDescriptor"
          ref="Employee" />
      </bean>
    </property>
  </bean>

  <bean
    id="Company"
    class="org.jspresso.framework.model.descriptor.entity.basic.BasicEntityDescriptor">
    <constructor-arg value="org.jspresso.hrsample.model.Company" />
    <property name="ancestorDescriptors">
      <list>
        <ref local="Nameable" />
        <ref local="Traceable" />
      </list>
    </property>
    <property name="propertyDescriptors">
      <list>
        <ref bean="contact" />
        <ref bean="Company-departments" />
        <ref bean="Company-employees" />
      </list>
    </property>
    <property
      name="iconImageURL"
      value="classpath:org/jspresso/hrsample/images/company-48x48.png" />
    <property name="renderedProperties">
      <list>
        <value>name</value>
        <value>contact</value>
        <value>createTimestamp</value>
        <value>lastUpdateTimestamp</value>
      </list>
    </property>
  </bean>

  <bean
    id="OrganizationalUnit-manager"
    class="org.jspresso.framework.model.descriptor.basic.BasicReferencePropertyDescriptor">
    <property
      name="name"
      value="manager" />
    <property
      name="referencedDescriptor"
      ref="Employee" />
    <property
      name="mandatory"
      value="true" />
    <property name="integrityProcessors">
      <list>
        <bean
          class="org.jspresso.hrsample.model.processor.OrganizationalUnitPropertyProcessors$ManagerProcessor" />
      </list>
    </property>
    <property name="initializationMapping">
      <map>
        <entry
          key="company"
          value="company" />
      </map>
    </property>
  </bean>

  <bean
    id="OrganizationalUnit"
    class="org.jspresso.framework.model.descriptor.entity.basic.BasicEntityDescriptor">
    <constructor-arg value="org.jspresso.hrsample.model.OrganizationalUnit" />
    <property
      name="purelyAbstract"
      value="true" />
    <property name="ancestorDescriptors">
      <list>
        <ref local="Nameable" />
        <ref local="Traceable" />
      </list>
    </property>
    <property name="propertyDescriptors">
      <list>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicStringPropertyDescriptor">
          <property
            name="name"
            value="ouId" />
          <property
            name="regexpPattern"
            value="[A-Z]{2}-[\d]{3}" />
          <property
            name="regexpPatternSample"
            value="AB-123" />
          <property
            name="maxLength"
            value="6" />
          <property
            name="mandatory"
            value="true" />
        </bean>
        <ref bean="contact" />
        <ref bean="OrganizationalUnit-manager" />
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicReferencePropertyDescriptor">
          <property
            name="name"
            value="company" />
          <property
            name="referencedDescriptor"
            ref="Company" />
          <property
            name="delegateClassName"
            value="org.jspresso.hrsample.model.extension.OrganizationalUnitExtension" />
        </bean>
      </list>
    </property>
  </bean>

  <bean
    id="Department-teams"
    class="org.jspresso.framework.model.descriptor.basic.BasicCollectionPropertyDescriptor">
    <property
      name="name"
      value="teams" />
    <property
      name="composition"
      value="true" />
    <property name="referencedDescriptor">
      <bean
        class="org.jspresso.framework.model.descriptor.basic.BasicCollectionDescriptor">
        <property
          name="collectionInterface"
          value="java.util.Set" />
        <property
          name="elementDescriptor"
          ref="Team" />
      </bean>
    </property>
  </bean>

  <bean
    id="Department"
    class="org.jspresso.framework.model.descriptor.entity.basic.BasicEntityDescriptor">
    <constructor-arg value="org.jspresso.hrsample.model.Department" />
    <property name="ancestorDescriptors">
      <list>
        <ref local="OrganizationalUnit" />
      </list>
    </property>
    <property name="propertyDescriptors">
      <list>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicReferencePropertyDescriptor">
          <property
            name="name"
            value="company" />
          <property
            name="referencedDescriptor"
            ref="Company" />
          <property
            name="reverseRelationEnd"
            ref="Company-departments" />
          <property
            name="mandatory"
            value="true" />
        </bean>
        <ref bean="Department-teams" />
      </list>
    </property>
    <property
      name="iconImageURL"
      value="classpath:org/jspresso/hrsample/images/department-48x48.png" />
    <property name="renderedProperties">
      <list>
        <value>ouId</value>
        <value>name</value>
        <value>manager</value>
        <value>contact</value>
      </list>
    </property>
  </bean>

  <bean
    id="Team"
    class="org.jspresso.framework.model.descriptor.entity.basic.BasicEntityDescriptor">
    <constructor-arg value="org.jspresso.hrsample.model.Team" />
    <property name="ancestorDescriptors">
      <list>
        <ref local="OrganizationalUnit" />
      </list>
    </property>
    <property name="propertyDescriptors">
      <list>
        <bean
          class="org.jspresso.framework.model.descriptor.basic.BasicReferencePropertyDescriptor">
          <property
            name="name"
            value="department" />
          <property
            name="referencedDescriptor"
            ref="Department" />
          <property
            name="reverseRelationEnd"
            ref="Department-teams" />
          <property
            name="mandatory"
            value="true" />
        </bean>
        <ref local="Team-teamMembers" />
      </list>
    </property>
    <property
      name="iconImageURL"
      value="classpath:org/jspresso/hrsample/images/team-48x48.png" />
    <property name="renderedProperties">
      <list>
        <value>ouId</value>
        <value>name</value>
        <value>manager</value>
        <value>contact</value>
      </list>
    </property>
  </bean>
</beans>
